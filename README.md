# Alexnet
## 1.描述
这个仓库里的代码是笔者在学习pytorch时自己复现的一个Alexnet网络
## 2.准备工作
### 2.1.数据集的下载
数据集的下载详细请看dataset_download.md文件  
这个实验的数据集使用的是torchvision里的CIFAR10数据集和网上下载的花分类数据集
### 2.2.预训练模型
这里其实是对预训练模型的一个说明  
笔者在使用数据集训练自己的模型时发现由于数据集质量的问题得到的模型性能不是很好（本来想下ImageNet，但是太大了目前没有这么大的算力），  
所以在torchvision里下载了一个训练好的Alexnet模型参数。  
笔者在本地跑的的时候为了方便管理是把参数文件放在该仓库下，但是上传到githup时为了方便被下载后本地运行，所以我把下载的任务也放在了pretrain_alexnet.py里，  
也就是说进行迁移学习时只需要运行pretrain_alexnet.py这个文件即可
## 3.结构
model.py文件是自定义的模型文件，针对两个数据集种类的不同，CIFAR10有十个种类，flowers数据集有5个种类，对最后一层的线性层做了不同的处理  
data_preprocess.py是对数据进行预处理的  
train.py是使用自己定义的网络进行训练  
pretrained_alexnet.py是使用预训练的模型进行迁移学习的
test.py是对模型进行验证
model_test_images是进行验证时使用的图片，读者可以放入自己喜欢的图片
## 4.使用
### 4.1建议先进行自定义网络的训练部分
直接运行train.py文件，会在当前的仓库里创建需要的文件夹。  
除了学习率，epoch等超参数外，还需要在选择使用的数据集，选择方式很简单我放在train.py的开头了
### 4.2迁移学习
和train.py文件一样，在开头选择使用的数据集，运行代码即可
### 4.3模型验证
这一部分需要把4.2和4.3都运行完，最后会在一个model文件夹里看到四个模型：  
alexnet_cifar10.pth alexnet_flowers.pth alexnet_cifar10_with_pretrained.pth alexnet_flowers_with_pretrained.pth  
然后就可以在test.py中进行模型验证了，具体流程是先选择模型的类别和使用的数据集，同样在代码开头已经定义好了，最后选择好测试图片的路径即可
## 5.对于模型训练结果的说明
### 5.1CIFAR10数据集
在这个数据集上无论是自己定义的模型还是预训练的模型的性能都很好，特别是使用预训练的参数可以让识别的准确率达到100%
### 5.2flowers数据集
这个数据集的模型性能较差，我推测的原因是Alexnet的结构还是过于简单了，在面对花分类这种不同类别之间的差别较小的任务时表现不够好，特别是自己定义的模型，基本上没有识别成功的，预训练的模型可以识别成功，但是判断的概率也只是在70%上下
